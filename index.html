<html>
    <head>
        <title>Descodeuses - insta test</title>
    </head>
    <body>
        <h1>Instagram Feed Test</h1>
        <button id="authorize">Authorize</button>
        <div id="feed">

        </div>
           <!--TOKEN = AQA6dEiNG5FFut8qGn6M57GTHc9R8ShtCRjeT2g9uorYfzEqa3rC_Px6QTZQ4OKR6Il45_vcNfrHyQXfcHBH7pwozRt1QgBUrz7s__P7EWDD1jgbEZm44E9SXixdKv3hEZmcX3x4oRKXhCrUslKepQRNQw8GvAmmZvrx6wEY3N_7KJCqTj1P7VRhEJP1LNb1wdn4CMPmjE8Ve3PulZeci6GmMLusBMZd5_7jPLiAHp1QXg-->
        

        <style>
            img {
                width: 200px;
            }
        </style>
        <script>
            document.getElementById('authorize').addEventListener('click', (event) => {
                window.open('https://api.instagram.com/oauth/authorize?client_id=210954820358365&redirect_uri=https://leiluspocus.github.io/instagram-feed-descodeuses/&scope=user_profile,user_media&response_type=code');
            });

            var superurl = new URLSearchParams(window.location.search);
            console.log(superurl);
            console.log(superurl.get("code"));
            if ( superurl.get("code") !== null) {
                console.log(superurl.get("code"));
                fetch('https://api.instagram.com/oauth/access_token', {
                    method: 'POST',
                    body: JSON.stringify(
                        {
                            client_id: '210954820358365', 
                            client_secret: '58e98af983ba2d9c8133f6a010fadc1a',
                            grant_type: 'authorization_code',
                            redirect_uri: 'https://leiluspocus.github.io/instagram-feed-descodeuses/',
                            code: superurl.get("code")
                        }
                    )
                }).then((response) => {
                    var content = response.json();
                    console.log(content);
                });


                /*fetch('https://graph.instagram.com/me/media?fields=id,caption,media_url,media_type,permalink&access_token=IGQVJXQmJSdGhWaUNEd2xoQnpjYmtfeVowcWdLWWxEakRjWVc2V3pYeUV4NEYtTUI2TW9JZAEdyQ2dtdWhjMUdQXzNUcmlKbk5obFlxcGxjVmdielVuenpRUm92RU9JRUpXNF9ZAMVFRWTlicTJicjZAudHVldWVTem50V1VJ')
                .then((response) => {
                    return response.json();
                })
                .then((response_json) =>{
                    var medias = response_json.data;
                    var feed_container = document.getElementById('feed');
                    medias.forEach((media) => {
                        var image = document.createElement('img');
                        image.src = media.media_url;
                        feed_container.appendChild(image);
                    });
                    console.log(response_json);
                });*/
            }

        </script>
   
    </body>
</html>